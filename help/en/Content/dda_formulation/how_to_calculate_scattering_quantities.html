<html>
    <head>
        <meta name="GENERATOR" content="Microsoft FrontPage 3.0">
        <title> How to calculate scattering quantities </title>
    </head>
    <body>
        <h1>How to calculate scattering quantities</h1>

<p><span>The simplest way to calculate scattering
quantities is to consider a set of point dipoles with known polarizations, as
summarized by Draine </span><span>[45]</span><span>. The
scattering amplitude <b>F</b>(<b>n</b>) is defined through the asymptotic expansion
of the electric field:</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>42</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>where <i>k</i><sub>sca</sub>
is the wave vector for the scattering direction. The original definition of Eq. </span><span>(<span>42</span>)</span><span> was
given in </span><span>[53]</span><span> for the
free-space scattering, when <i>k</i><sub>sca</sub> = <i>k</i> and the scattering amplitude is</span></p>

<table>
 <tr>
  <td>
  <p><span>.</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>43</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>We generalize this definition to the surface
mode (§</span><span>7</span><span>) by
defining <i>k</i><sub>sca</sub> = <i>m</i><sub>sca</sub><i>k</i>, where <i>m</i><sub>sca</sub>
is the refractive index at the scattering direction – either 1 (above surface, <i>n<sub>z</sub></i> &#8805; 0) or <i>m</i><sub>s</sub> (below surface, <i>n<sub>z</sub></i> &lt; 0). For the
scattering amplitude in Eq. </span><span>(<span>42</span>)</span><span> we
have two separate cases. Above the surface the result is a combination of
directly scattered [Eq. </span><span>(<span>43</span>)</span><span>] and the
following reflected wave</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>44</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>while below the surface (<i>n<sub>z</sub></i> &lt; 0) – the
scattering amplitude is</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>45</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>The definitions are the same as used in Eqs. </span><span>(<span>15</span>)</span><span>, </span><span>(<span>16</span>)</span><span> but for
a wave propagating back from the scattering direction, i.e. <b>a</b> = &#8722;<b>n</b> (or <b>k</b><sub>in</sub> = &#8722;<i>k</i><sub>sca</sub><b>n</b>) and . In particular, the transmission coefficients in Eq. </span><span>(<span>45</span>)</span><span> are
for transmission of wave from the substrate into the vacuum. Eqs. </span><span>(<span>44</span>)</span><span>, </span><span>(<span>45</span>)</span><span> are
based on the reciprocity principle </span><span>[54]</span><span>, but
can also be obtained from the far-field limit of surface Green’s tensor (see
Appendix D of </span><span>[55]</span><span>). Factor
<i>m</i><sub>s</sub> in Eq. </span><span>(<span>45</span>)</span><span> comes
from <i>k</i><sub>sca</sub> in Eq. </span><span>(<span>42</span>)</span><span>.</span></p>

<p><span>Note that consideration of specific scattering
angle (and wavenumber) in Eq. </span><span>(<span>42</span>)</span><span> implies
that we completely ignore the surface plasmon polaritons, which can, in
principle, be considered as scattering at 90°.</span></p>

<p><span>The amplitude and Mueller scattering matrices
for direction <b>n</b> are determined from <b>F</b>(<b>n</b>)
calculated for two incident polarizations (§</span><span>11.2</span><span>, §</span><span>11.3</span><span>). Time-averaged
Poynting vector of the scattered field <b>S</b><sub>sca</sub>
is a second-order function of <b>F</b>(<b>n</b>):</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>46</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>where <i>m</i><sub>sca</sub> is a step function of <b>n</b> (relevant in the surface mode), and
the exponent is relevant only for scattering into the absorbing substrate. Scattering
cross section <i>C</i><sub>sca</sub> and
asymmetry vector <b>g</b> are determined by
integration of <b>S</b><sub>sca</sub>(<b>r</b>) over the whole solid angle </span><span>[53]</span><span>:</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>47</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>48</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>where <i>I</i><sub>0</sub>
is the incident irradiance (§</span><span>9.2</span><span>) and
the rightmost parts are obtained by neglecting the exponent, depending on <i>r</i>. The latter are actually used by </span><span><span>ADDA</span></span><span>.<a><span><span><span><span>[49]</span></span></span></span></a> The
definition of <b>g </b>is generalized to
the surface mode, but this quantity has a clear physical meaning related to the
momentum of the scattered field only in the free-space mode (§</span><span>11.6</span><span>). Extinction
and absorption cross section (<i>C</i><sub>ext</sub>
and <i>C</i><sub>abs</sub>) </span><span>[53]</span><span> are determined directly from <b>P</b><i><sub>i</sub></i>:</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>49</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>.</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>50</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>Variations of Eq. </span><span>(<span>50</span>)</span><span>
(which is used by default) are possible, for instance </span><span>[14]</span><span>:</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>51</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>which is based on considering radiation
correction of a <i>finite</i> dipole instead
of a <i>point</i> dipole used in Eq. </span><span>(<span>50</span>)</span><span>. The
difference between these two expressions is subtle and depends on
polarizability formulation (§</span><span>10.1</span><span>). In
particular, it is zero if and only if <b>M&#773;</b> &#8722; (2/3)i(<i>kd</i>)<sup>3</sup>
is a Hermitian tensor. For LDR, CLDR, and SO the difference is </span><span>&#119978;</span><span>((<i>kd</i>)<sup>2</sup>), but only when </span><span>&#8465;</span><span>(<i>m</i>) &#8800; 0.
For CM and LAK the difference is </span><span>&#119978;</span><span>((<i>kd</i>)<sup>3</sup>)
and </span><span>&#119978;</span><span>((<i>kd</i>)<sup>5</sup>) respectively for any <i>m</i>. For all
other formulations the difference is always zero.</span></p>

<p><span>Corrections to the above expressions are
possible, considering the far-field limit of IGT interaction term (§</span><span>10.2</span><span>), in
particular </span><span>[47]</span></p>

<table>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><span>(</span><span><span>52</span></span><span>)</span></p>
  </td>
 </tr>
 <tr>
  <td>
  <p><span>,</span></p>
  </td>
  <td>
  <p><a><span>(</span></a><span><span><span>53</span></span></span><span><span>)</span></span></p>
  </td>
 </tr>
</table>

<p><span>IGT<sub>SO</sub> is
based on truncating Taylor expansion in Eq. </span><span>(<span>53</span>)</span><span> and
applying the result [1 &#8722; (<i>kd</i>)<sup>2</sup>/24] as a
multiplicative factor in Eqs.</span><span>(<span>43</span>)</span><span> and </span><span>(<span>49</span>)</span><span>.
Other expressions are unchanged, although <i>C</i><sub>sca</sub> is effectively
multiplied by the square of this factor.</span></p>

<p><span>The choice between
different ways to calculate scattering quantities is performed by command line
option</span></p>

<p><span>-scat &lt;type&gt;</span></p>

<p><span>where </span><span>&lt;type&gt;</span><span> is </span><span>dr</span><span>, </span><span>fin</span><span>, </span><span>igt_so</span><span>, or </span><span>so</span><span>. Draine’s classical formulation (</span><span>dr</span><span>)
corresponds to Eqs. </span><span>(<span>43</span>)</span><span>, </span><span>(<span>49</span>)</span><span>, and </span><span>(<span>50</span>)</span><span>.
Finite dipole correction (</span><span>fin</span><span>) uses Eq. </span><span>(<span>51</span>)</span><span> to
calculate <i>C</i><sub>abs</sub>. A few
quick tests showed that finite dipole correction do <i>not</i> improve the accuracy, so using the default </span><span>dr</span><span> is recommended in most cases. However, </span><span><span>igt_so</span></span><span> is recommended, when the same formulation (or IGT) is used for
interaction term (§</span><span>10.2</span><span>).</span></p>

<p><i><span>C</span></i><sub><span>sca</span></sub><span> can be determined as <i>C</i><sub>ext</sub> &#8722; <i>C</i><sub>abs</sub> (in free-space mode or
for non-absorbing substrate), which is faster than Eq. </span><span>(<span>47</span>)</span><span>. However,
this issue needs further clarifying. Draine noted </span><span>[45]</span><span>
that <i>C</i><sub>sca</sub> calculated by
integration over the solid angle can be more accurate than <i>C</i><sub>ext</sub> &#8722; <i>C</i><sub>abs</sub>, due to loss of significant digits when the latter
two cross sections have close to equal values. Moreover, it has been suggested </span><span>[56]</span><span> that the
difference between <i>C</i><sub>sca</sub>
calculated by these two methods can be used as an internal measure of DDA
accuracy. However, we stress that this difference is a measure of convergence
of the iterative solver and accuracy of the integration over the solid angle,
but not of the physical approximation itself (in the default mode “</span><span><span>&#8209;scat dr</span></span><span>”). In other words, the difference may be very small, while the
values themselves are very inaccurate (compared to the exact solution). To
prove this, one may consider a supplementary disconnected particle consisting
of a set of point dipoles with the same positions and polarizabilities as
dipoles representing the original (connected) particle. For this supplementary
particle DDA equations </span><span>(20)</span><span>
involve no approximations, since they directly follow from the constitutive
equations of a point dipole.<a><span><span><span><span>[50]</span></span></span></span></a>
Therefore, their exact solution will satisfy the optical theorem, which can be
formulated as <i>C</i><sub>sca</sub> = <i>C</i><sub>ext</sub> &#8722; <i>C</i><sub>abs</sub>. Hence, the only
possible reasons for the latter to be violated are inaccurate solution of
Eq. </span><span>(20)</span><span> or
inaccurate calculation of Eq. </span><span>(47)</span><span>. And
the difference between the original and supplementary particles, which is the
error of the DDA itself, is not relevant. The simulations comply with this
conclusion (data not shown, but see parts 12 and 13 of the tutorial</span><sup><span>17</span></sup><span>).</span></p>

<p><span>Similar
conclusions are valid for other symmetry-based tests. For instance, recently a
reciprocity condition, i.e. the invariance of the simulation results when
incident and scattered directions are exchanged, was studied in the framework
of the DDA </span><span>[57]</span><span>. It
was shown that reciprocity condition is automatically satisfied for the DDA results,
whenever polarizability formulation (§</span><span>10.1</span><span>) is
independent of the incident direction (or at least the same for two reciprocal
configurations). In other words, the difference of results between two
reciprocal configurations can be very small (on the order of the threshold of
the iterative solver, §</span><span>12.1</span><span>),
while the results themselves are completely wrong. And even for the LDR or CLDR
polarizability the level of fulfillment of the reciprocity condition (while not
trivial) is still not an adequate measure of the overall DDA accuracy.</span></p>


    </body>
</html>